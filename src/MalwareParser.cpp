#include <fstream>
#include "MalwareParser.h"

ParseFileResult MalwareParser::processFile(const std::filesystem::path &path) {
    if (is_directory(path)) {
        return ParseFileResult::ERROR;
    }

    std::ifstream file(path.string());
    if (file.is_open()) {
        std::string line;
        // Hmm. Can this line be REALLY HUGE?
        while (std::getline(file, line)) {
            auto line_res = line_database_.checkLine(line);
            if (line_res != ParseFileResult::CLEAR) {
                return line_res;
            }
        }
        file.close();
    } else {
        return ParseFileResult::ERROR;
    }

    return ParseFileResult::CLEAR;
}
